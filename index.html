<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>AR Scene with GLTF</title>

<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

</head>
<body style="margin:0; overflow:hidden;">

<a-scene
  vr-mode-ui="enabled: false"
  embedded
  arjs="sourceType: webcam; debugUIEnabled: false;">

  <!-- Assets -->
  <a-assets>
    <audio id="clickSound" src="u-i-i-ai-o-uu-ii-a-i-remix-_.mp3"></audio>
  </a-assets>

  <!-- Light -->
  <a-light type="directional" position="0 1 0" intensity="0.8"></a-light>
  <a-light type="ambient" color="#CCC" intensity="0.5"></a-light>

  <!-- Model -->
  <a-entity id="box"
    gltf-model="scene.gltf"
    position="0 1.5 -1"
    scale="1 1 1"
    rotation="1.5 1.5 -1"
    animation__rotate="property: rotation; to: 0 360 0; loop: true; dur: 2000; startEvents: startSpin; pauseEvents: stopSpin"
    animation__bounce="property: position; to: 0 1.5 -1; dir: alternate; loop: true; dur: 550; startEvents: startBounce; pauseEvents: stopBounce"
    >
  </a-entity>

  <!-- Sound -->
  <a-sound id="sound" src="#clickSound"></a-sound>

<!-- กล้อง + cursor -->
  <a-camera>
    <a-cursor
      fuse="false"
      rayOrigin="mouse">
    </a-cursor>
  </a-camera>
</a-scene>

<script>
  const box = document.querySelector('#box');
  const sound = document.querySelector('#sound');
  const cam = document.querySelector('#cam');
  let active = false;

  // Click = หมุน + เด้ง + เสียง
  box.addEventListener('click', () => {
    if (!active) {
      box.emit('startSpin');
      box.emit('startBounce');
    } else {
      box.emit('stopSpin');
      box.emit('stopBounce');
    }
    sound.components.sound.playSound();
    active = !active;
  });

  // Scroll = Zoom
  window.addEventListener('wheel', (e) => {
    let zoomSpeed = 0.01;
    cam.object3D.position.z += e.deltaY * zoomSpeed;
  });
</script>
</body>
</html>
